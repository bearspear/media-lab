<div class="tags-container">
  <div class="tags-header">
    <div>
      <h1 class="tags-title">Tags</h1>
      <p class="tags-subtitle">Organize and categorize your items with custom tags</p>
    </div>
    <button
      pButton
      label="New Tag"
      icon="pi pi-plus"
      (click)="openCreateDialog()"
      class="create-btn">
    </button>
  </div>

  <div *ngIf="loading" class="loading-state">
    <i class="pi pi-spin pi-spinner loading-spinner"></i>
  </div>

  <div *ngIf="!loading && tags.length === 0" class="empty-state">
    <div class="empty-state-icon">
      <i class="pi pi-tags"></i>
    </div>
    <h2 class="empty-state-title">No Tags Yet</h2>
    <p class="empty-state-desc">Create tags to categorize and organize your items</p>
    <button
      pButton
      label="Create Tag"
      icon="pi pi-plus"
      (click)="openCreateDialog()">
    </button>
  </div>

  <div *ngIf="!loading && tags.length > 0" class="tags-grid">
    <div *ngFor="let tag of tags" class="tag-card">
      <div class="tag-card-header">
        <div class="tag-icon" [style.background-color]="tag.color || '#3B82F6'">
          <i class="pi pi-tag"></i>
        </div>
        <div class="tag-actions">
          <button
            pButton
            icon="pi pi-pencil"
            class="p-button-text p-button-sm p-button-rounded"
            (click)="openEditDialog(tag)"
            pTooltip="Edit">
          </button>
          <button
            pButton
            icon="pi pi-trash"
            class="p-button-text p-button-danger p-button-sm p-button-rounded"
            (click)="deleteTag(tag)"
            pTooltip="Delete">
          </button>
        </div>
      </div>

      <h3 class="tag-name">{{ tag.name }}</h3>

      <div class="tag-meta">
        <i class="pi pi-book"></i>
        <span>{{ getItemCount(tag) }} items</span>
      </div>
    </div>
  </div>
</div>

<!-- Create/Edit Tag Dialog -->
<p-dialog
  [(visible)]="showDialog"
  [header]="isEditMode ? 'Edit Tag' : 'Create Tag'"
  [modal]="true"
  [style]="{width: '450px'}"
  [closable]="true"
  styleClass="tag-dialog">

  <div class="dialog-content">
    <div class="form-field">
      <label for="name" class="field-label">
        Name <span class="required">*</span>
      </label>
      <input
        pInputText
        id="name"
        [(ngModel)]="currentTag.name"
        placeholder="Enter tag name"
        class="w-full"
        autofocus />
    </div>

    <div class="form-field">
      <label for="color" class="field-label">
        Color
      </label>
      <div class="color-picker-group">
        <p-colorPicker
          [(ngModel)]="currentTag.color"
          [inline]="false">
        </p-colorPicker>
        <div
          class="color-preview"
          [style.background-color]="currentTag.color">
        </div>
        <span class="color-value">
          {{ currentTag.color }}
        </span>
      </div>
    </div>

    <div class="tag-preview-section">
      <label class="field-label">Preview:</label>
      <div class="tag-preview" [style.background-color]="currentTag.color">
        <i class="pi pi-tag"></i>
        {{ currentTag.name || 'Tag Name' }}
      </div>
    </div>
  </div>

  <ng-template pTemplate="footer">
    <button
      pButton
      label="Cancel"
      icon="pi pi-times"
      class="p-button-text"
      (click)="showDialog = false">
    </button>
    <button
      pButton
      [label]="isEditMode ? 'Update' : 'Create'"
      icon="pi pi-check"
      (click)="saveTag()">
    </button>
  </ng-template>
</p-dialog>

<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
